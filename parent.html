<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Judicial Case Law Citations</title>
<style>
@font-face {
    font-family: "CANDARAB";
    src: url(css/CANDARAB.ttf) format("truetype");
}
  html,body {
    margin: 0px;
    padding: 0px;
	width: 100%;
	height: 100%;
	overflow:hidden;
    background-color: none;
	font-family: "CANDARAB","Righteous","Trebuchet MS", "Open Sans", Segoe UI light, Verdana, Tahoma, Helvetica, sans-serif;
  font-weight: normal;
  font-style: normal;
  }
  iframe {
	border:none;
	position:fixed;
	top:0;
	left:0;
	width:738px;
	height:700px;
		-webkit-transition: margin-left 1s;
	  -moz-transition: margin-left 1s;
	  -o-transition: margin-left 1s;
	  -ms-transition: margin-left 1s;       
	  transition: margin-left 1s;
  }
.dragdealer {
	height: 5%;
	background: #111;
	z-index: 8;
}
.dragdealer .handle {
	top: 0;
	left: 0;
	cursor: pointer;
}
.orange-bar {
	width: 8%;
	height: 100%;
	background: #5C7785;
	color: #092331;
	font-size: 140%;
	line-height: 160%;
	padding-left:0.3%;
	text-align: center;
	font-weight: bold;
}
.orange-bar:hover {
	background: #997
}
.dragdealer .disabled {
	background: #898989
}
#reload:hover #arrows {
	fill:#444;
}
#reload, #title, #bigyear, #bigyear2, #timeslider, #author, #author2, #author3 {
	-webkit-transition: opacity 0.5s;
	  -moz-transition: opacity 0.5s;
	  -o-transition: opacity 0.5s;
	  -ms-transition: opacity 0.5s;       
	  transition: opacity 0.5s;
}
a {
	cursor:pointer;
	text-decoration:none;
	font-size:10px;
	color:#000;
}
a:hover, #author3:hover {
	text-decoration:underline;
}
</style>
<script src="js/dragdealer.js"></script>
<script src="js/readResponse.js"></script>
</head>

<script src="js/readResponse.js"></script>

<script>
function onSubmit()
{
	dataSubmitted();
}

</script>


<body>


	</head>

	
<div id="container" style="width:1272px;height:700px;margin:0px;">
<div id="title" style="position:fixed;left:260px;z-index:-1;font-size:48px;text-align:center;margin-top:10px;color:#092331;opacity:0;">Judicial Case<br>Law Citations</div>

<div id="refList" style="position:fixed;left:280px;top:140px;z-index:-1;font-size:14px;text-align:left;margin-top:10px;color:#3D5C6D";opacity:0;"></div>

<div id="bigyear" style="position:fixed;left:175px;z-index:100;font-size:200px;text-align:center;margin-top:160px;color:#000;opacity:0;visibility:hidden;">Welcome</div>
<div id="author" style="position:fixed;left:420px;z-index:100;font-size:48px;text-align:center;margin-top:573px;color:092331;opacity:0;">
	
	<a href="http://knomos.ca" target="_blank"><img src="logo1.png" alt="Knomos student project." title="Ken Mansfield, CS 547." style="width:90px;height:24px;border:solid 1px #111;margin-top:5px;"/></a>
	<a href="http://ubc.ca" target="_blank"><img src="ubclogo.jpg" alt="CS 547." title="CS 547." style="width:72px;height:72px;border:solid 1px #111;margin-top:5px;"/></a>	
</div>
<div id="author2" style="position:fixed;left:5px;z-index:100;font-size:48px;text-align:center;margin-top:562px;color:#111;opacity:0;">
	
	<a href="http://www.delimited.io/blog/2014/11/18/interactive-chord-diagrams-in-d3" target="_blank" title="inspired by"><div style="color:3D5C6D;">inspired by</div>delimited.io</a><br>
	<a href="http://colorbrewer2.org/" target="_blank" title="chord colors by"><div style="color:3D5C6D;">chord colors by</div>colorbrewer2.org</a><br>
	<a href="http://knomos.ca/" target="_blank" title="data from"><div style="color:3D5C6D;">data from</div>knomos.ca</a><br>
		
</div>
<div id="author3" style="position:fixed;right:10px;z-index:100;font-size:28px;text-align:center;margin-top:620px;color:092331;opacity:0;cursor:pointer;" onclick="window.parent.document.getElementById('content').src='parent.html'" title="reload page">
	reload page
	
</div>

<iframe id="iframe1" style="margin-left:600px;z-index:-1" src="iframe1.html"></iframe>
<iframe id="iframe2" style="margin-left:0px;width:500px" src="iframe2.html"></iframe>



</div>

<div  id="bigyear2"  class="dragdealer" style="bottom:0px;left:0px;width:100%;position:fixed;opacity:0; background-color:#ddd;z-index:5000;"></div>
<div  id="timeslider" title="<-  drag slider, scroll or use arrow keys to change year  ->" class="dragdealer" style="bottom:0px;left:0px;width:100%;position:fixed;opacity:0;font-size:18px;">
<div style="position:fixed;left:5%;z-index:-1;font-size:100%;color:#092331;margin-top:0.4%;"><-  drag slider, scroll or use arrow keys to change year  -></div>
<div class="handle orange-bar" id="timehandle" style="text-align:center;vertical-align: middle;height:100%">2014</div>
</div>

<script>


function trans(){
	var a=document.getElementById('iframe1').style.marginLeft;
	document.getElementById('iframe1').style.marginLeft=document.getElementById('iframe2').style.marginLeft;
	document.getElementById('iframe2').style.marginLeft=a;
	//document.getElementById('reload').style.opacity=0;
	//setTimeout(function(){document.getElementById('reload').style.opacity=1;},500);
	document.getElementById('title').style.opacity=0;
	setTimeout(function(){document.getElementById('title').style.opacity=1;},500);
	document.getElementById('author').style.opacity=0;
	setTimeout(function(){document.getElementById('author').style.opacity=1;},500);
	}

var timedragdealer=new Dragdealer("timeslider", {
	x: 1,
	steps: 1,
	animationCallback: function(a, b) {
		var theSteps = 1;
		var currentStep = this.getStep()[0];

		document.getElementById('timehandle').innerHTML=getSelectedCase(currentStep - 1);
	},
	callback: function(a, b) {
		var currentStep = this.getStep()[0];
		var theSteps = timedragdealer.options.steps;
		var dontFilter = false;
		if(isNaN(currentStep))
		{
			currentStep = 1;
		}
		if(currentStep == theSteps)
		{
			document.getElementById('iframe1').contentWindow.angular.element("body").scope().isFinalYear=true;
		}
		else
		{
			document.getElementById('iframe1').contentWindow.angular.element("body").scope().isFinalYear=false;
		}
		var selectedCase = getSelectedCase(currentStep - 1);
		document.getElementById('iframe1').contentWindow.angular.element("body").scope().selected_year=selectedCase;
		document.getElementById('iframe1').contentWindow.angular.element("body").scope().update();
		
		document.getElementById('bigyear').innerHTML=getSoc(selectedCase);
		showCitedBy(selectedCase);
		
		setTimeout(function(){
			setTimeout(function(){
				document.getElementById('bigyear').style.opacity=0;
				setTimeout(function(){
					document.getElementById('bigyear').style.visibility='hidden';},
					700);
				},
			700);
			document.getElementById('bigyear').style.visibility='visible';
			document.getElementById('bigyear').style.opacity=0.3;},
		2100);
	}
});

function updateTimeSlider(newNumberOfSteps)
{
	document.getElementById('timeslider').style.opacity=1;
	timedragdealer.options.steps = newNumberOfSteps;
 	timedragdealer.init();
 	//timedragdealer.setValue(0.0);
 	document.getElementById('iframe2').contentWindow.document.getElementById('playButton').style.visibility = 'visible';
 	playTimeLine();
 
 	//need to set bigyear correctly here as well.
 	console.log(newNumberOfSteps);
}

function moveTimeSlider(direction)
{
	var currentStep = timedragdealer.getStep()[0];
	var stepObj = {};
	var nextStep = currentStep + direction;
	stepObj.steps = timedragdealer.options.steps;
	
	if(currentStep != null && stepObj.steps > 1 && stepObj.steps > 1 && direction == 0)
	{
		//doing a bit of a hack for the play animation. If direction == 0, then start the timeline at 0.
		nextStep = 1;
		timedragdealer.setStep(1);
	}
	else if(nextStep <= 0 || nextStep > stepObj.steps)
	{
		//don't move!
		nextStep = currentStep;
	}
	else
	{
		timedragdealer.setStep(nextStep);
	}
	
	stepObj.currentStep = nextStep;

	return stepObj;
}

function keyPresses( event ) 
{
	if (( event.keyCode >= 33 && event.keyCode <= 34 ) || (event.keyCode >= 37 && event.keyCode <= 40)) {
		switch( event.keyCode ) {
			case 34: // pg up
			case 39: // right

			case 38: // up
			{		
					moveTimeSlider(+1);
					break;
			}
			case 33: // pg down
			case 37: // left
			case 40: // down 
			{	
					moveTimeSlider(-1);
					break;
			}
		}
		
		event.preventDefault();
	}
}
	
document.addEventListener("keydown", keyPresses, false);
document.getElementById('iframe1').addEventListener("keydown", keyPresses, false);
document.getElementById('iframe2').addEventListener("keydown", keyPresses, false);

   document.addEventListener("mousewheel", function ( event ) {
	if (event.wheelDelta<0) 
	{
		moveTimeSlider(-1);
	}
	else 
	{
		moveTimeSlider(+1);; 
	}
   }, false);
   
			
	var rescale = function() {
	//scale content
	var scal = Math.min((document.getElementById("container").parentElement.offsetWidth) / document.getElementById("container").offsetWidth, (document.getElementById("container").parentElement.offsetHeight) / document.getElementById("container").offsetHeight)
	document.getElementById("container").style.WebkitTransform = "scale(" + scal + ")";
	document.getElementById("container").style.OTransform = "scale(" + scal + ")";
	document.getElementById("container").style.MozTransform = "scale(" + scal + ")";
	document.getElementById("container").style.msTransform = "scale(" + scal + ")";
	document.getElementById("container").style.Transform = "scale(" + scal + ")";

	document.getElementById("container").style.WebkitTransformOrigin = "0 0";
	document.getElementById("container").style.OTransformOrigin = "0 0";
	document.getElementById("container").style.MozTransformOrigin = "0 0";
	document.getElementById("container").style.msTransformOrigin = "0 0";
	document.getElementById("container").style.TransformOrigin = "0 0";
	
	document.getElementById("timeslider").style.fontSize = scal*20;
	var targetDiv = document.getElementById("timeslider").getElementsByClassName("handle orange-bar")[0];
	targetDiv.style.fontSize = scal*20;
	
	targetDiv.style.verticalAlign = "bottom";
	};
	
	window.onresize = function() {
	rescale();
	}
	//init content
	rescale();
	setTimeout(function()
	{
		document.getElementById('timeslider').style.opacity=0;
	},1000)
	
	setTimeout(function(){
				setTimeout(function(){
					document.getElementById('bigyear').style.opacity=0;
					document.getElementById('bigyear2').style.opacity=0;
					setTimeout(function(){
						document.getElementById('bigyear').style.visibility='hidden';
						document.getElementById('bigyear2').style.visibility='hidden';},
						700);
					},
				700);
				document.getElementById('bigyear').style.visibility='visible';
				document.getElementById('bigyear').style.opacity=0.3;
				document.getElementById('bigyear2').style.visibility='visible';
				document.getElementById('bigyear2').style.opacity=0.5;},
			2000);
	
	setTimeout(function(){
		document.getElementById('title').style.opacity=1;
	},1000)
	
	setTimeout(function(){
		document.getElementById('author').style.opacity=1;
		document.getElementById('author2').style.opacity=1;
		document.getElementById('author3').style.opacity=1;
	},2000)
</script>
</body>

</html>